**[⬅ ย้อนกลับ](https://got2546.github.io/)**

# --- ___ปัญหาที่ตรวจพบจาก RIPS___ ---
![This is an alt text.](/img/img2/50.jpg)


# โปรแกรมที่ใช้และวิธีดาวน์โหลดและติดตั้ง
# [Download VirtualBox](/VirtualBox.md)<br>
# [WinSCP 6.5 Download](/WinSCP.md)

# Help - Session Fixation แล้วกดดาวน์โหลดไฟล์ติดตั้ง (Setup.exe)


#### แนวคิดของช่องโหว่

| source | sink | vulnerability |
| :---- | :----: | ----: |
| 1$_POST + | setcookie() | = Session Fixation |

# คำอธิบายช่องโหว่ (Vulnerability Description)
Session Fixation เป็นช่องโหว่ที่ผู้โจมตีสามารถบังคับให้ผู้ใช้งานใช้ Session ID ที่ผู้โจมตีกำหนดไว้ล่วงหน้า ได้ เมื่อผู้ใช้งานทำการเข้าสู่ระบบเรียบร้อยแล้ว ผู้โจมตีจะสามารถใช้ Session ID เดียวกันนั้น เพื่อเข้าถึงบัญชีของผู้ใช้งานและสวมรอยเป็นผู้ใช้งานได้ทันที

###### กล่าวโดยสรุปคือ

> ระบบยอมรับ Session ID จากผู้ใช้โดยตรง ทำให้ผู้ไม่หวังดีสามารถควบคุม Session ของผู้อื่นได้


# ตัวอย่างโค้ดที่มีช่องโหว่ (Vulnerable Example Code)

```php
setcookie("PHPSESSID", $_GET["sessid"]);
```

> โค้ดตัวอย่างนี้แสดงให้เห็นว่า
ระบบนำค่า Session ID ที่รับมาจากผู้ใช้ผ่าน URL ไปตั้งค่าเป็น Session ของระบบโดยตรง ซึ่งเป็นพฤติกรรมที่ไม่ปลอดภัย

# ตัวอย่างการโจมตี (Proof of Concept)

```bash
/index.php?sessid=1f3870be274f6c49b3e31a0c6728957f
```

> ผู้โจมตีสามารถส่ง Session ID ผ่าน URL ให้ผู้ใช้งาน หากระบบนำค่า Session ID นี้ไปใช้งานจริง ผู้โจมตีก็สามารถใช้ Session เดียวกันเข้ามาในระบบได้ภายหลัง

# แนวทางการแก้ไข (Patch)
## ไม่ควรนำ Session Token หรือ Session ID ที่ผู้ใช้ส่งเข้ามาไปใช้งานโดยตรง
ระบบควรเป็นผู้สร้างและจัดการ Session ID เองทั้งหมด เพื่อป้องกันไม่ให้ผู้โจมตีสามารถกำหนด Session ID ให้ผู้ใช้งานได้

```bash
1. No code.
```

# ฟังก์ชันที่ช่วยเพิ่มความปลอดภัย (Related Securing Functions)

> ไม่มีฟังก์ชันเฉพาะที่ระบุไว้
แต่ควรใช้การจัดการ Session ของฝั่ง Server อย่างเหมาะสม เช่น การสร้าง Session ID ใหม่จากระบบเท่านั้น

>>># None.

